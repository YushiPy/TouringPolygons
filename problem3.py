
from itertools import cycle, product

from pygame import Color
from problem1 import Solution
from vector2 import Vector2
from polygon2 import Polygon2

import matplotlib.pyplot as plt
from shapely.geometry import Polygon, Point
from scipy.spatial import Delaunay
import numpy as np

COLORS = [
	"red", "blue", "green", "orange", "purple", "cyan", "magenta", "yellow", "teal", "lavender", "brown", "beige", "maroon", "mint", "olive", "coral", "navy", "grey", "white", "black"
]

def polygon_to_convex(polygon: Polygon):
	# Get polygon points
	points = np.array(polygon.exterior.coords[:-1])
	# Perform Delaunay triangulation
	tri = Delaunay(points)
	triangles = []
	for simplex in tri.simplices:
		tri_pts = points[simplex]
		tri_poly = Polygon(tri_pts)
		# Keep only triangles fully inside the polygon
		if polygon.contains(tri_poly.centroid):
			triangles.append(tri_poly)
	return triangles

def solve(start, end, polygons):

	start = Vector2(start)
	end = Vector2(end)
	
	parts = [[Polygon2(x.exterior.coords[:-1]) for x in polygon_to_convex(Polygon(poly))] for poly in polygons]
	possibles = list(product(*(range(len(part)) for part in parts)))

	c = cycle(COLORS)

	WHITE = Color("white")
	BLACK = Color("black")

	for i, (base_poly, p) in enumerate(zip(polygons, parts), 1):

		base_color = Color(next(c))

		bc = "#" + "".join(hex(i)[2:].zfill(2) for i in tuple(base_color)[:3])
		plt.plot(*zip(*(list(base_poly) + [base_poly[0]])), color="white", alpha=1, linewidth=3)
		plt.plot(*zip(*(list(base_poly) + [base_poly[0]])), color=bc, linewidth=1.5)

		plt.fill([-1], [-1], label=f"Polygon {i}", color=bc)

		for j, poly in enumerate(p):

			rate = j / len(p) * 0.7
			color = base_color.lerp(WHITE if i % 2 else BLACK, rate)
			color = "#" + "".join(hex(i)[2:].zfill(2) for i in tuple(color)[:3])

			plt.fill(*zip(*poly), color="white", alpha=1)
			plt.fill(*zip(*poly), color=color, alpha=0.3)
			plt.plot(*zip(*(poly + (poly[0],))), alpha=0.3, color="black") # type: ignore

	paths = []

	for p in possibles:
		sol = Solution(start, end, [parts[i][a] for i, a in enumerate(p)])
		try: paths.append(sol.solve())
		except: pass

	best = min(paths, key=lambda path: sum((path[i] - path[i-1]).magnitude() for i in range(1, len(path))))

	return best

def solve_random(start, end, polygons, tries: int = 10 ** 4):

	start = Vector2(start)
	end = Vector2(end)
	
	parts = [[Polygon2(x.exterior.coords[:-1]) for x in polygon_to_convex(Polygon(poly))] for poly in polygons]

	c = cycle(COLORS)

	WHITE = Color("white")
	BLACK = Color("black")

	for i, (base_poly, p) in enumerate(zip(polygons, parts), 1):

		base_color = Color(next(c))

		bc = "#" + "".join(hex(i)[2:].zfill(2) for i in tuple(base_color)[:3])
		plt.plot(*zip(*(list(base_poly) + [base_poly[0]])), color="white", alpha=1, linewidth=3)
		plt.plot(*zip(*(list(base_poly) + [base_poly[0]])), color=bc, linewidth=1.5)

		plt.fill([-1], [-1], label=f"Polygon {i}", color=bc)

		for j, poly in enumerate(p):

			rate = j / len(p) * 0.7
			color = base_color.lerp(WHITE if i % 2 else BLACK, rate)
			color = "#" + "".join(hex(i)[2:].zfill(2) for i in tuple(color)[:3])

			plt.fill(*zip(*poly), color="white", alpha=1)
			plt.fill(*zip(*poly), color=color, alpha=0.3)
			plt.plot(*zip(*(poly + (poly[0],))), alpha=0.3, color="black") # type: ignore

	paths = []

	for _ in range(tries):

		indeces = [random.randint(0, len(part) - 1) for part in parts]
		sol = Solution(start, end, [parts[i][a] for i, a in enumerate(indeces)])

		try: paths.append(sol.solve())
		except: pass

	best = min(paths, key=lambda path: sum((path[i] - path[i-1]).magnitude() for i in range(1, len(path))))

	return best

def star(center, radius, points, rotation=0.0):

	"""
	Generate the points of a star-shaped polygon.

	:param center: The center of the star (x, y).
	:param radius: The radius of the outer points of the star.
	:param points: The number of points (or spikes) of the star.
	:param rotation: The rotation angle in radians.

	:return: A list of (x, y) tuples representing the vertices of the star.
	"""

	angle = np.linspace(0, 2 * np.pi, points, endpoint=False) + rotation
	outer_points = np.array([[np.cos(a), np.sin(a)] for a in angle]) * radius + center
	inner_angle = angle + np.pi / points
	inner_radius = radius / 2
	inner_points = np.array([[np.cos(a), np.sin(a)] for a in inner_angle]) * inner_radius + center
	star_points = np.empty((points * 2, 2))
	star_points[0::2] = outer_points
	star_points[1::2] = inner_points
	return star_points

import random
make_star = lambda: star((random.uniform(-8, 8), random.uniform(-8, 8)), random.uniform(2, 5), random.randint(5, 10), random.uniform(0, 2 * np.pi)).tolist()

stars = [make_star() for _ in range(4)]

stars = [
	[(0.0, 6.0), (0.0, -1.0), (1.0, -1.0), (1.0, 4.0), (3.0, 1.0), (5.0, 4.0), (5.0, -1.0), (6.0, -1.0), (6.0, 6.0), (5.0, 6.0), (3.0, 3.0), (1.0, 6.0)],
	[(-2.0, 6.0), (-2.0, -1.0), (-1.0, -1.0), (-1.0, 6.0)],
	[(7.0, -1.0), (7.0, 6.0), (11.0, 6.0), (11.0, 5.0), (8.0, 5.0), (8.0, 3.0), (11.0, 3.0), (11.0, 2.0), (8.0, 2.0), (8.0, -0.0), (11.0, -0.0), (11.0, -1.0)],
]

_stars = [
	[(-5.22, 5.64), (-5.66, 5.84), (-6.32, 6.0), (-6.82, 6.06), (-7.44, 6.06), (-8.12, 5.88), (-8.52, 5.6), (-8.82, 5.28), (-9.1, 5.5), (-9.18, 5.88), (-9.22, 6.34), (-9.32, 6.74), (-9.1, 7.26), (-8.92, 7.68), (-8.62, 8.14), (-8.38, 8.5), (-8.36, 8.86), (-8.66, 9.02), (-9.02, 8.94), (-9.28, 9.22), (-9.76, 8.98), (-10.02, 8.46), (-10.32, 7.88), (-10.48, 7.36), (-10.54, 6.78), (-10.5, 5.9), (-10.38, 5.36), (-10.2, 4.78), (-9.9, 4.06), (-9.66, 3.68), (-9.78, 3.08), (-9.76, 2.32), (-9.7, 1.8), (-9.56, 1.0), (-9.96, 1.22), (-9.96, 1.8), (-10.28, 1.5), (-10.44, 1.96), (-10.06, 2.5), (-10.5, 2.52), (-10.9, 2.26), (-11.02, 1.72), (-11.26, 1.58), (-11.42, 2.02), (-11.58, 2.3), (-11.96, 2.56), (-12.44, 2.68), (-12.14, 2.28), (-11.96, 1.9), (-11.96, 1.54), (-12.08, 1.28), (-12.38, 1.28), (-12.44, 1.58), (-12.62, 1.06), (-12.54, 0.66), (-12.42, 0.28), (-12.84, 0.32), (-13.06, 0.16), (-12.78, -0.02), (-12.72, -0.32), (-12.98, -0.52), (-13.5, -0.52), (-13.9, -0.22), (-14.08, 0.1), (-14.16, 0.34), (-14.2, -0.16), (-14.14, -0.66), (-14.02, -1.14), (-13.74, -1.4), (-13.46, -1.68), (-13.62, -1.94), (-14.02, -1.92), (-13.7, -2.12), (-13.4, -2.24), (-12.94, -2.24), (-12.48, -2.26), (-12.24, -2.12), (-12.4, -2.52), (-12.62, -2.76), (-11.98, -2.66), (-12.0, -3.08), (-11.86, -3.26), (-11.54, -2.98), (-11.16, -2.76), (-10.78, -2.68), (-10.8, -2.96), (-11.08, -3.16), (-11.28, -3.52), (-11.3, -3.82), (-10.86, -3.64), (-10.46, -3.64), (-10.46, -4.02), (-10.76, -4.26), (-10.3, -4.36), (-9.84, -4.22), (-9.48, -4.06), (-9.74, -4.84), (-10.4, -6.3), (-10.6, -7.4), (-10.9, -8.78), (-10.76, -8.98), (-10.28, -8.24), (-9.66, -7.3), (-8.98, -6.64), (-8.1, -6.04), (-7.26, -5.86), (-6.14, -5.98), (-6.02, -6.9), (-6.02, -7.56), (-5.42, -6.82), (-5.22, -5.84), (-5.28, -5.2), (-5.64, -4.52), (-6.18, -4.18), (-6.52, -4.0), (-6.5, -3.66), (-6.1, -3.78), (-5.6, -3.7), (-5.18, -3.86), (-5.14, -3.36), (-4.86, -3.42), (-4.54, -3.66), (-4.62, -4.08), (1.86, -6.46), (-3.2, -2.98), (-3.82, -3.1), (-3.98, -2.74), (-3.26, -2.72), (-2.72, -2.02), (-3.38, -1.98), (-3.02, -1.72), (-2.36, -2.1), (-2.54, -1.3), (-3.34, -0.9), (-3.24, -0.28), (-3.82, -0.04), (-3.8, -0.44), (-4.2, -0.6), (-4.9, -0.42), (-4.42, -0.08), (-4.16, 0.3), (-4.0, 0.86), (-3.88, 1.5), (-3.9, 2.2), (-4.12, 3.38), (-4.2, 4.26), (-4.02, 5.16), (-4.04, 6.16), (-4.36, 7.18), (-4.7, 7.72), (-5.08, 8.14), (-5.34, 8.38), (-5.68, 8.08), (-6.1, 8.14), (-6.18, 7.76), (-5.9, 7.26), (-5.48, 6.68), (-5.24, 6.2), (-5.14, 5.88)],
	[(4.46, 9.56), (4.1, 9.08), (3.82, 8.32), (3.62, 7.48), (3.5, 6.9), (3.34, 5.98), (3.26, 5.1), (3.18, 4.22), (3.18, 3.26), (3.18, 2.46), (3.34, 1.4), (3.5, 0.32), (3.84, -0.46), (4.12, -1.34), (4.4, -1.88), (4.82, -2.32), (5.38, -2.66), (5.82, -2.76), (6.22, -2.58), (6.5, -2.3), (6.74, -2.38), (6.86, -2.72), (6.7, -2.86), (6.2, -3.02), (5.4, -3.36), (4.82, -4.02), (4.7, -4.48), (4.64, -4.88), (5.2, -4.72), (5.92, -4.48), (6.62, -4.58), (7.24, -4.62), (7.7, -4.84), (7.56, -4.5), (7.26, -4.28), (6.7, -4.08), (6.36, -4.12), (5.7, -4.06), (5.88, -3.8), (6.44, -3.66), (7.14, -3.46), (7.74, -3.44), (8.06, -3.82), (8.38, -3.88), (8.8, -3.8), (8.94, -3.56), (9.3, -3.34), (9.64, -3.92), (10.2, -4.14), (10.66, -3.96), (11.06, -3.72), (11.1, -3.18), (11.14, -2.62), (11.32, -2.04), (12.02, -2.02), (12.04, -2.38), (12.2, -3.34), (12.32, -4.7), (12.2, -6.16), (11.94, -7.28), (11.54, -8.26), (11.04, -9.14), (10.48, -9.8), (11.48, -9.06), (12.12, -7.98), (12.46, -6.96), (12.72, -5.94), (12.84, -4.66), (12.86, -3.34), (12.64, -2.0), (13.62, -1.22), (13.88, -0.36), (13.84, 0.34), (13.38, 0.98), (13.08, 1.46), (13.74, 2.04), (14.06, 2.64), (14.16, 3.48), (14.14, 4.1), (13.72, 4.42), (13.06, 4.36), (12.8, 4.1), (13.0, 5.2), (12.82, 6.08), (12.34, 6.46), (11.84, 6.48), (11.28, 6.04), (11.38, 6.64), (11.68, 7.5), (12.02, 8.12), (12.26, 8.64), (11.98, 8.7), (11.68, 8.28), (11.26, 7.44), (10.84, 6.52), (10.52, 7.22), (10.04, 7.68), (9.34, 7.76), (8.9, 7.34), (8.82, 6.52), (9.0, 5.72), (8.52, 5.8), (7.9, 5.9), (7.72, 7.14), (7.48, 8.08), (7.14, 8.88), (6.62, 9.82), (6.36, 9.82), (6.48, 9.22), (6.58, 8.14), (6.58, 7.14), (6.58, 6.36), (6.44, 5.16), (6.38, 4.46), (6.14, 3.6), (5.84, 3.0), (5.56, 2.48), (5.2, 2.22), (4.84, 2.32), (4.68, 2.76), (4.4, 3.72), (4.06, 5.06), (4.16, 6.24), (4.2, 7.36), (4.38, 8.46), (4.52, 9.48)],
	[(13.48, 9.14), (8.82, 7.22), (8.62, 7.4), (-3.5, 1.74), (8.02, 5.56), (8.42, 6.0), (8.64, 6.54), (10.22, 7.3), (13.66, 8.82), (14.06, 9.04), (14.66, 8.8), (15.1, 9.1), (15.1, 9.7), (14.62, 9.82), (14.22, 9.66), (14.02, 9.42)],
]

_stars = [
	[(-7.1, 4.18), (-6.46, 4.76), (-5.72, 4.84), (-5.14, 4.82), (-4.54, 4.66), (-4.18, 4.46), (-4.2, 4.94), (-4.44, 5.56), (-4.94, 6.08), (-4.88, 6.52), (-4.52, 6.5), (-4.22, 6.7), (-3.6, 6.0), (-3.2, 4.96), (-3.2, 3.94), (-3.44, 3.5), (-3.16, 2.22), (-3.12, 1.08), (-3.36, 0.24), (-3.86, -0.34), (-3.3, -0.48), (-2.94, -0.24), (-3.14, -0.06), (-2.58, -0.2), (-2.64, -0.74), (-2.16, -0.92), (-1.9, -1.32), (-1.86, -1.7), (-2.22, -1.44), (-2.62, -1.44), (-2.62, -1.66), (-2.16, -1.62), (-2.36, -1.86), (-2.72, -2.0), (-2.54, -2.14), (-3.16, -2.18), (-3.2, -2.4), (-3.08, -2.58), (-2.7, -2.4), (1.5, -5.06), (-3.76, -3.36), (-3.6, -3.02), (-3.86, -2.74), (-4.2, -2.62), (-3.94, -2.94), (-4.08, -3.14), (-4.32, -2.96), (-4.92, -3.08), (-5.18, -2.92), (-5.22, -3.28), (-4.54, -3.72), (-4.22, -4.06), (-4.16, -4.9), (-4.36, -5.54), (-4.74, -6.04), (-4.74, -5.58), (-4.96, -4.74), (-5.58, -4.6), (-6.28, -4.78), (-7.04, -5.18), (-7.82, -5.94), (-8.36, -6.9), (-8.58, -7.34), (-8.66, -6.84), (-8.44, -5.72), (-8.14, -4.74), (-7.64, -3.56), (-7.7, -3.32), (-8.18, -3.52), (-8.62, -3.34), (-8.4, -3.14), (-8.4, -2.86), (-8.72, -2.9), (-9.0, -3.04), (-8.96, -2.7), (-8.58, -2.3), (-8.62, -2.08), (-8.88, -2.1), (-9.46, -2.56), (-9.58, -2.24), (-10.06, -2.28), (-9.82, -1.96), (-10.04, -1.76), (-10.84, -1.78), (-11.26, -1.52), (-10.7, -1.5), (-11.22, -1.0), (-11.34, -0.24), (-11.3, 0.26), (-10.98, -0.4), (-10.42, -0.46), (-10.14, -0.32), (-10.4, 0.06), (-10.02, 0.24), (-10.08, 0.72), (-10.0, 1.2), (-9.9, 1.02), (-9.62, 1.18), (-9.6, 1.6), (-9.94, 2.12), (-9.58, 2.12), (-9.22, 1.82), (-8.98, 1.16), (-8.8, 1.88), (-8.12, 2.08), (-8.26, 1.74), (-8.28, 1.18), (-8.08, 1.42), (-7.98, 0.94), (-7.64, 0.8), (-7.78, 1.42), (-7.86, 2.18), (-7.76, 2.96), (-8.4, 4.56), (-8.4, 5.86), (-8.08, 6.74), (-7.48, 7.36), (-7.24, 7.28), (-7.26, 7.18), (-6.7, 7.16), (-6.64, 6.98), (-7.06, 6.26), (-7.4, 5.48), (-7.28, 4.5)],
	[(3.56, 7.56), (3.08, 6.56), (2.78, 5.12), (2.54, 3.66), (2.58, 2.12), (2.72, 0.72), (2.92, -0.16), (3.26, -0.92), (3.56, -1.48), (4.1, -2.04), (4.58, -2.1), (4.88, -2.1), (5.2, -1.88), (5.42, -1.76), (5.4, -2.08), (5.62, -2.24), (4.8, -2.5), (4.4, -2.72), (4.04, -3.1), (3.74, -3.5), (3.72, -3.88), (3.96, -3.82), (4.24, -3.66), (4.8, -3.56), (5.22, -3.58), (5.68, -3.68), (6.24, -3.9), (6.04, -3.64), (5.66, -3.42), (5.08, -3.2), (4.48, -3.24), (4.98, -2.94), (5.64, -2.8), (6.22, -2.72), (6.44, -3.06), (6.82, -3.12), (7.04, -2.98), (7.24, -2.72), (7.4, -2.66), (7.58, -3.04), (7.86, -3.16), (8.26, -3.28), (8.56, -3.2), (8.88, -2.98), (8.92, -2.5), (8.96, -2.04), (9.1, -1.68), (9.46, -1.7), (9.6, -1.66), (9.74, -2.36), (9.82, -3.22), (9.78, -5.02), (9.52, -6.06), (8.98, -7.02), (8.42, -7.8), (9.38, -6.94), (10.02, -5.58), (10.28, -3.96), (10.22, -2.4), (10.1, -1.56), (10.78, -1.22), (11.1, -0.52), (11.12, -0.0), (10.94, 0.52), (10.5, 0.96), (10.52, 1.22), (11.1, 1.82), (11.4, 2.6), (11.2, 3.32), (10.84, 3.62), (10.4, 3.4), (10.16, 3.28), (10.3, 3.86), (10.36, 4.42), (10.18, 4.9), (9.72, 5.14), (9.38, 5.12), (9.14, 4.86), (9.0, 4.74), (9.28, 5.56), (9.46, 6.3), (9.86, 6.94), (9.74, 7.02), (9.46, 6.74), (9.2, 6.38), (8.88, 5.82), (8.7, 5.28), (8.24, 5.96), (7.78, 6.3), (7.32, 6.22), (7.04, 5.86), (7.08, 5.38), (7.12, 4.84), (7.12, 4.66), (6.86, 4.66), (6.48, 4.8), (6.3, 4.78), (5.9, 6.62), (5.42, 7.74), (5.02, 8.4), (5.12, 7.64), (5.22, 7.02), (5.3, 5.78), (5.34, 4.96), (5.2, 3.88), (4.98, 2.9), (4.7, 2.3), (4.4, 1.88), (3.94, 1.82), (3.58, 2.48), (3.4, 3.22), (3.28, 4.86), (3.36, 6.26)],
	[(7.32, 6.16), (-2.94, 1.36), (6.12, 4.32), (6.62, 4.78), (6.96, 5.24), (7.26, 5.52), (11.32, 7.22), (11.72, 7.1), (12.06, 7.18), (12.48, 7.42), (12.76, 7.8), (12.66, 8.16), (12.42, 8.36), (12.06, 8.4), (11.64, 8.28), (11.38, 8.02), (11.32, 7.68), (11.28, 7.5), (7.88, 6.12), (7.54, 6.04)],
]

_stars = [
	[(0.14, -3.92), (-0.06, -3.96), (-0.2, -4.02), (-0.28, -4.14), (-0.34, -4.06), (-0.34, -3.96), (-0.22, -3.84), (-0.28, -3.82), (-0.2, -3.72), (-0.3, -3.64), (-0.42, -3.7), (-0.56, -3.78), (-0.66, -4.0), (-0.6, -4.18), (-0.52, -4.32), (-0.4, -4.4), (-0.28, -4.46), (-0.3, -4.66), (-0.14, -4.88), (-0.3, -4.88), (-0.44, -4.94), (-0.6, -5.02), (-0.74, -5.1), (-0.84, -5.16), (-1.06, -5.16), (-1.04, -5.2), (-1.2, -5.24), (-1.06, -5.3), (-1.22, -5.54), (-1.0, -5.42), (-1.1, -5.58), (-0.7, -5.4), (-0.78, -5.56), (-0.8, -5.68), (-0.52, -5.42), (-0.56, -5.5), (-0.34, -5.32), (-0.22, -5.32), (-0.42, -5.46), (-0.28, -5.48), (-0.38, -5.64), (-0.34, -5.72), (-0.16, -5.48), (-0.12, -5.76), (-0.02, -5.9), (0.04, -5.72), (0.14, -5.56), (0.36, -5.54), (0.46, -5.74), (0.58, -5.86), (0.66, -5.76), (0.62, -5.66), (0.62, -5.54), (0.74, -5.66), (0.76, -5.6), (0.66, -5.52), (0.78, -5.52), (0.74, -5.46), (0.68, -5.4), (0.62, -5.3), (0.66, -5.2), (0.74, -5.28), (0.84, -5.28), (1.02, -5.32), (1.04, -5.44), (2.42, -5.58), (1.18, -5.08), (1.12, -5.2), (0.92, -5.16), (0.78, -5.1), (0.72, -5.02), (0.58, -4.84), (0.66, -4.74), (0.76, -4.64), (0.74, -4.46), (0.92, -4.34), (1.06, -4.18), (1.06, -4.06), (1.02, -3.92), (0.96, -3.78), (0.84, -3.66), (0.66, -3.68), (0.66, -3.8), (0.68, -3.88), (0.78, -4.04), (0.78, -4.18), (0.68, -4.1), (0.66, -3.98), (0.38, -3.92)],
	[(0.04, -2.8), (-0.18, -2.32), (-0.12, -2.2), (-0.34, -1.22), (-0.42, -0.4), (-0.52, -0.28), (-0.44, -0.14), (-0.4, 0.08), (-0.48, 0.08), (-0.48, 0.22), (-0.32, 0.44), (-0.42, 0.44), (-0.4, 0.56), (-0.56, 0.48), (-0.56, 0.62), (-0.44, 0.74), (-0.4, 1.06), (-0.64, 1.14), (-0.72, 0.96), (-0.78, 0.64), (-0.92, 0.74), (-0.94, 0.82), (-1.14, 0.54), (-1.36, 0.36), (-1.4, 0.5), (-1.36, 0.64), (-1.62, 0.46), (-1.72, 0.32), (-1.86, 0.26), (-1.86, 0.48), (-1.8, 0.6), (-2.34, 0.34), (-2.42, 0.38), (-2.42, 0.48), (-2.7, 0.14), (-2.88, 0.06), (-2.82, 0.34), (-2.74, 0.58), (-2.48, 0.88), (-2.78, 0.76), (-2.98, 0.6), (-3.12, 0.52), (-3.08, 0.78), (-2.9, 0.98), (-3.48, 0.7), (-3.8, 0.48), (-4.0, 0.44), (-3.86, 0.7), (-3.54, 0.96), (-3.12, 1.18), (-3.84, 0.9), (-3.5, 1.32), (-4.02, 0.96), (-3.8, 1.34), (-3.6, 1.58), (-3.3, 1.72), (-3.46, 1.72), (-3.76, 1.6), (-4.08, 1.38), (-4.04, 1.54), (-3.74, 1.84), (-3.32, 2.06), (-2.8, 2.16), (-2.5, 2.12), (-1.92, 2.38), (-1.62, 2.34), (-1.46, 2.42), (-1.56, 2.58), (-1.36, 2.6), (-1.2, 2.64), (-1.22, 2.74), (-1.14, 2.88), (-0.82, 2.98), (-0.84, 3.12), (-0.62, 3.16), (-0.46, 3.24), (-0.56, 3.26), (-0.78, 4.26), (-0.48, 3.9), (-0.28, 3.56), (-0.18, 3.4), (-0.22, 3.28), (-0.18, 3.2), (-0.1, 3.26), (-0.06, 3.34), (-0.12, 3.42), (-0.12, 3.58), (0.02, 4.94), (0.24, 3.48), (0.14, 3.38), (0.14, 3.26), (0.2, 3.2), (0.32, 3.26), (0.32, 3.38), (0.36, 3.52), (0.84, 4.26), (0.64, 3.32), (0.52, 3.28), (0.52, 3.2), (0.58, 3.16), (0.68, 3.16), (0.84, 3.2), (0.82, 3.06), (0.98, 2.98), (1.1, 2.86), (1.26, 2.72), (1.34, 2.64), (1.38, 2.54), (1.36, 2.5), (1.48, 2.5), (1.66, 2.42), (1.62, 2.32), (1.64, 2.28), (2.02, 2.22), (2.5, 2.22), (2.96, 2.22), (3.44, 2.14), (3.8, 2.04), (4.0, 1.8), (4.08, 1.54), (4.12, 1.44), (3.72, 1.74), (3.38, 1.84), (3.26, 1.82), (3.6, 1.68), (3.78, 1.46), (3.96, 1.18), (3.98, 1.06), (3.56, 1.26), (3.44, 1.14), (3.7, 0.96), (3.92, 0.7), (3.88, 0.56), (3.72, 0.5), (3.48, 0.76), (3.18, 0.94), (2.9, 1.08), (3.08, 0.74), (3.12, 0.56), (2.9, 0.7), (2.72, 0.84), (2.9, 0.56), (2.96, 0.2), (2.82, 0.18), (2.68, 0.44), (2.3, 0.7), (2.62, 0.32), (2.6, 0.3), (2.42, 0.34), (2.16, 0.48), (2.0, 0.62), (2.02, 0.4), (1.94, 0.4), (1.48, 0.7), (1.48, 0.56), (1.24, 0.46), (1.1, 0.44), (1.14, 0.88), (1.12, 0.72), (1.04, 0.74), (0.88, 0.96), (0.88, 1.16), (0.6, 1.1), (0.46, 1.0), (0.52, 0.82), (0.62, 0.54), (0.54, 0.56), (0.46, 0.38), (0.58, 0.14), (0.52, 0.06), (0.58, -0.32), (0.48, -0.38), (0.44, -1.26), (0.24, -2.18), (0.32, -2.34)],
]

_stars = [
	[(-2.56, -4.14), (-1.02, -1.48), (-0.72, -1.7), (-1.06, -2.28), (-0.18, -3.76), (0.52, -3.76), (0.52, -4.12)],
	[(2.2, -0.42), (3.96, -0.44), (3.06, -1.96)],
	[(0.7, 1.52), (-0.84, -1.16), (-0.54, -1.36), (-0.14, -0.74), (1.56, -0.74), (1.96, -1.36), (2.28, -1.16)],
	[(-0.24, -4.44), (1.64, -4.44), (0.74, -6.08)],
	[(2.14, -1.72), (2.46, -2.26), (1.54, -3.78), (0.88, -3.78), (0.88, -4.12), (4.0, -4.12), (2.48, -1.52)],
	[(-2.54, -0.4), (-0.72, -0.4), (-1.64, -1.92)],
	[(6.74, 6.84), (6.6, 6.42), (6.3, 5.82), (5.96, 5.28), (5.6, 4.72), (5.2, 4.18), (5.06, 3.94), (5.26, 3.94), (5.74, 4.32), (6.28, 4.76), (6.72, 4.94), (7.26, 5.02), (7.52, 5.0), (7.42, 5.34), (7.48, 5.74), (7.72, 5.96), (8.14, 6.08), (8.52, 6.1), (8.88, 6.14), (9.36, 6.0), (9.18, 6.28), (9.08, 6.54), (9.22, 6.82), (9.62, 7.04), (10.2, 7.4), (10.8, 7.88), (10.2, 7.62), (9.66, 7.42), (9.1, 7.22), (8.42, 7.06), (7.64, 6.92)],
	[(-6.7, 6.86), (-6.68, 6.68), (-6.58, 6.44), (-6.34, 5.92), (-5.42, 4.54), (-5.14, 4.1), (-5.06, 3.98), (-5.16, 3.94), (-5.38, 4.1), (-5.9, 4.48), (-6.38, 4.8), (-6.92, 4.98), (-7.48, 5.04), (-7.44, 5.3), (-7.44, 5.6), (-7.62, 5.9), (-8.2, 6.12), (-8.7, 6.08), (-9.32, 6.04), (-9.2, 6.2), (-9.08, 6.46), (-9.14, 6.68), (-9.46, 6.94), (-9.9, 7.24), (-10.4, 7.58), (-10.78, 7.86), (-10.32, 7.72), (-9.88, 7.5), (-9.48, 7.36), (-8.86, 7.18), (-8.02, 6.98), (-7.26, 6.92)],
	[(-5.86, 0.76), (-7.16, 1.16), (-6.06, 0.22), (-6.28, -0.24), (-6.44, -0.86), (-6.56, -1.48), (-6.66, -2.2), (-6.7, -2.82), (-6.66, -3.38), (-6.6, -3.94), (-6.52, -4.4), (-5.16, -3.6), (-5.42, -3.2), (-5.14, -2.72), (-5.52, -2.38), (-5.08, -1.8), (-5.32, -0.72), (-4.38, -1.52), (-4.58, -1.88), (-4.2, -2.22), (-4.64, -2.64), (-3.94, -3.26), (-4.24, -3.56), (-3.24, -4.12), (-3.32, -3.68), (-3.36, -3.1), (-3.4, -2.42), (-3.32, -1.74), (-3.22, -1.14), (-3.0, -0.46), (-2.64, 0.24), (-2.12, 0.88), (-1.52, 1.38), (-0.66, 1.86), (0.0, 2.02), (0.8, 2.06), (1.36, 2.0), (1.98, 1.88), (2.46, 1.74), (2.94, 1.42), (3.46, 1.06), (3.82, 0.64), (4.18, 0.12), (4.5, -0.44), (4.72, -1.2), (4.84, -2.1), (4.78, -2.98), (4.52, -4.04), (3.96, -5.04), (3.2, -5.88), (2.5, -6.4), (1.66, -6.8), (0.7, -7.06), (-0.32, -7.12), (-1.22, -6.96), (-1.88, -6.72), (-2.6, -6.3), (-3.4, -5.62), (-3.94, -4.94), (-4.36, -4.12), (-4.62, -3.36), (-4.86, -2.62), (-4.9, -3.58), (-4.72, -4.38), (-4.34, -5.18), (-3.92, -5.88), (-3.46, -6.32), (-2.82, -6.94), (-2.18, -7.34), (-1.4, -7.64), (-0.62, -7.86), (0.46, -7.86), (1.44, -7.82), (2.3, -7.56), (3.44, -7.02), (4.08, -6.54), (4.76, -5.86), (5.36, -5.08), (5.86, -3.98), (6.2, -2.7), (6.3, -1.36), (6.16, -0.38), (5.98, 0.2), (7.08, 1.18), (5.78, 0.76), (5.46, 1.22), (6.72, 2.62), (5.06, 1.78), (4.74, 2.24), (5.58, 3.34), (4.3, 2.66), (3.42, 3.34), (2.38, 3.88), (1.1, 4.24), (-0.12, 4.32), (-1.18, 4.24), (-1.9, 4.08), (-2.98, 3.68), (-3.74, 3.24), (-4.4, 2.68), (-5.72, 3.38), (-4.82, 2.26), (-5.16, 1.84), (-6.84, 2.64), (-5.56, 1.28)],
]

start = (-5.0, 5.0)
end = (5.0, -2.0)

minx = min(min(min(p[0] for p in x) for x in stars), start[0], end[0]) - 1
maxx = max(max(max(p[0] for p in x) for x in stars), start[0], end[0]) + 1
miny = min(min(min(p[1] for p in x) for x in stars), start[1], end[1]) - 1
maxy = max(max(max(p[1] for p in x) for x in stars), start[1], end[1]) + 1

plt.figure(figsize=(6, 6))
plt.xlim(minx, maxx)
plt.ylim(miny, maxy)

plt.fill([minx, maxx, maxx, minx], [miny, miny, maxy, maxy], color="#ccd7d8", alpha=0.5) # type: ignore

# plt.plot(*zip(*path), color="purple", linewidth=2, linestyle="dashed", marker="o", markersize=3) # type: ignore

path = solve(start, end, stars)

for a, b, color in zip(path, path[1:], COLORS):
	plt.plot([a[0], b[0]], [a[1], b[1]], color="white", linewidth=3.5, marker="o", markersize=3) # type: ignore
	plt.plot([a[0], b[0]], [a[1], b[1]], color=color, linewidth=2, linestyle="dashed", marker="o", markersize=3, alpha=0.7) # type: ignore

# plt.plot(*zip(*path), color="purple", linewidth=2, linestyle="dashed", marker="o", markersize=3) # type: ignore

plt.plot([start[0]], [start[1]], color="white", alpha=1, marker="o") # type: ignore
plt.scatter([start[0]], [start[1]], color="green", alpha=1, marker="o", label="Start") # type: ignore
plt.plot([start[0]], [start[1]], color="green", alpha=1, marker="o") # type: ignore

plt.plot([end[0]], [end[1]], color="white", alpha=1, marker="o") # type: ignore
plt.scatter([end[0]], [end[1]], color="red", alpha=1, marker="o", label="End") # type: ignore
plt.plot([end[0]], [end[1]], color="red", alpha=1, marker="o") # type: ignore
plt.plot([minx - 1], [miny], color="purple", linewidth=2, linestyle="dashed", marker="o", markersize=3, label="Path") # type: ignore

plt.gca().set_aspect('equal', adjustable='box')

plt.grid() # type: ignore
plt.legend() # type: ignore
plt.tight_layout()

plt.savefig("output2.png", bbox_inches="tight", dpi=300) # type: ignore

plt.show() # type: ignore